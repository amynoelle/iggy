<!--
Copyright 2011, 2012 Massachusetts Institute of Technology

This work is sponsored by the Department of the Air Force under Air Force
Contract #FA8721-05-C-0002. Opinions, interpretations, conclusions and
recommendations are those of the authors and are not necessarily endorsed by the
United States Government.
-->

<!--
    Playback velodyne data from a given rosbag file.

    This launch file will start its own nodelet manager.

    Required Arguments:
     - bag - (str) Path to the bag file to be played back.

    Optional Arguments:
     - manager - (str) Override the default manager name
     - rate - (float) Adjust the playback rate of the bag file
     - rosbag_args - (str) additional rosbag arguments (such as --loop)
-->

<launch>
    <!-- Required Parameters -->
    <arg name="bag"/>

    <!-- Optional Parameters -->
    <arg name="rate" default="1.0"/>
    <arg name="manager" default="velodyne_nodelet_manager"/>
    <arg name="rosbag_args" default=""/>

    <!-- Set to sim_time -->
    <param name="use_sim_time" value="true"/>

    <!-- Play the rosbag -->
    <node name="rosbag" pkg="rosbag" type="play"
        args="--rate $(arg rate)
              --clock
              --delay 1
              $(arg rosbag_args)
              $(arg bag)"/>

    <node pkg="nodelet" type="nodelet" name="$(arg manager)" args="manager"/>
    <include file="$(find velodyne_bringup)/launch/pointcloud_from_bag.launch">
        <arg name="manager" value="$(arg manager)"/>
    </include>
</launch>
